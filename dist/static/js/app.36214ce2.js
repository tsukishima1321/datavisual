(function(){"use strict";var e={7222:function(e,l,a){var t=a(3751),n=a(641),u=a(953),r=a(8548),o=(0,n.pM)({__name:"Head",setup(e){return(e,l)=>{const a=(0,n.g2)("el-icon"),t=(0,n.g2)("el-menu-item"),o=(0,n.g2)("el-menu");return(0,n.uX)(),(0,n.Wv)(o,{"default-active":"/",class:"headermenu",mode:"horizontal",ellipsis:!1,router:!0},{default:(0,n.k6)(()=>[(0,n.bF)(t,{index:"/"},{default:(0,n.k6)(()=>[(0,n.bF)(a,null,{default:(0,n.k6)(()=>[(0,n.bF)((0,u.R1)(r.HomeFilled))]),_:1}),l[0]||(l[0]=(0,n.eW)("Home"))]),_:1,__:[0]}),(0,n.bF)(t,{index:"/about"},{default:(0,n.k6)(()=>[(0,n.bF)(a,null,{default:(0,n.k6)(()=>[(0,n.bF)((0,u.R1)(r.MoreFilled))]),_:1}),l[1]||(l[1]=(0,n.eW)("About"))]),_:1,__:[1]})]),_:1})}}}),i=a(6262);const s=(0,i.A)(o,[["__scopeId","data-v-00b20027"]]);var d=s,c=(0,n.pM)({__name:"App",setup(e){return(e,l)=>{const a=(0,n.g2)("router-view");return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.bF)(d),(0,n.bF)(a)],64)}}});const v=c;var m=v,p=a(5220),f=a(33),b=a(3680),k=a(1132),h=a(163),y=a(8207),g=a(1857),_=a(8930),R=a(8062),F=a(716),x=a(8135),V=a(2012),w=a(8224),S=a(2085),C=a(3671);const L=(e,l)=>{const a=[];for(let t=0;t<e;t++)for(let e=0;e<l;e++){const n=t+e/l;a.push(n.toFixed(2)+"s")}return a},K=(e,l)=>{if(0===e.length||l<=0||l>=100)return{maxValue:0,maxValueIndex:-1,rangeStart:-1,rangeEnd:-1};let a=-1/0,t=-1,n=-1,u=-1;for(let r=0;r<e.length;r++){const l=e[r];l>a&&(a=l,t=r)}if(-1===t)return{maxValue:0,maxValueIndex:-1,rangeStart:-1,rangeEnd:-1};for(let r=t;r>=0;r--){if(!(e[r]>=a*(l/100)))break;n=r}for(let r=t;r<e.length;r++){if(!(e[r]>=a*(l/100)))break;u=r}return{maxValue:a,maxValueIndex:t,rangeStart:n,rangeEnd:u}},N=(e,l=.5,a=.02)=>{const t=e.length;if(t<3)return[];const n=e.reduce((e,l)=>e+l,0)/t,u=e.reduce((e,l)=>e+Math.pow(l-n,2),0)/t,r=Math.sqrt(u),o=Math.max(Math.floor(t*a),5),i=n+l*r,s=Math.min(Math.floor(t/10),50),d=[];for(let b=0;b<t;b++)d[b]=new Array(s).fill(!1);for(let b=1;b<=s;b++)for(let l=b;l<t-b;l++)e[l]>e[l-b]&&e[l]>e[l+b]&&e[l]>=i&&(d[l][b-1]=!0);const c=new Array(s).fill(0);for(let b=0;b<s;b++)for(let e=0;e<t;e++)d[e][b]&&c[b]++;let v=1,m=1/0;for(let b=Math.max(1,Math.floor(o/2));b<=Math.min(s,2*o);b++)c[b-1]>0&&c[b-1]<m&&(m=c[b-1],v=b);m===1/0&&(v=Math.min(s,o));const p=[];for(let b=0;b<t;b++)v<=s&&d[b][v-1]&&p.push(b);const f=[];p.sort((l,a)=>e[a]-e[l]);for(const b of p){let l=!0;for(const e of f)if(Math.abs(b-e)<o){l=!1;break}if(l){const l=Math.max(3,Math.floor(o/3));let a=!0;for(let n=Math.max(0,b-l);n<=Math.min(t-1,b+l);n++)if(n!==b&&e[n]>=e[b]){a=!1;break}a&&f.push(b)}}return f.sort((e,l)=>e-l),f},A=(e,l)=>{const a=[],t=e.length,n=1/l;for(let u=0;u<t;u++)a[u]=0===u?(e[u+1]-e[u])/n:1===u||u===t-2?(e[u+1]-e[u-1])/(2*n):u===t-1?(e[u]-e[u-1])/n:(-e[u+2]+8*e[u+1]-8*e[u-1]+e[u-2])/(12*n);return a},E=(e,l)=>{if(l<=0||l>e.length)return e.slice();const a=Math.floor(l/2),t=new Array(e.length).fill(0);for(let n=0;n<e.length;n++){let l=0,u=0;for(let t=-a;t<=a;t++){const a=n+t;a>=0&&a<e.length&&(l+=e[a],u++)}t[n]=l/u}return t};var W=a(3959);const M={class:"chartwrapper"},U={class:"control-panel"},P={class:"transfer-panel"},$={class:"data-correction-panel"},I={class:"correction-select"},X={class:"correction-operation"},O={key:0,class:"correction-value"},H={key:1,class:"input-group"},B={class:"correction-apply-mode"},j={key:2,class:"correction-new-name"},T={class:"correction-buttons"},z={class:"comparison-panel"},D={class:"comparison-select"},q={class:"select-group"},Q={class:"select-group"},Z={class:"comparison-operation"},Y={class:"comparison-result-name"},J={class:"comparison-buttons"},G={class:"analysis-controls"},ee={class:"analysis-row"},le={class:"analysis-row"},ae={key:0,class:"analysis-result"},te={class:"analysis-controls"},ne={class:"input-group"},ue={class:"input-group"},re={class:"analysis-row"},oe={key:0,class:"peak-search-result"},ie={class:"analysis-row"},se={class:"export-controls"},de={class:"chartColumn"},ce={class:"chart-config"},ve={class:"input-group config-item"},me={class:"zoom-controls config-item"},pe={class:"input-group"},fe=["max"],be={class:"input-group"},ke=["min","max"],he={class:"data-info"},ye={class:"y-axis-controls config-item"},ge={class:"input-group"},_e={class:"dialog-footer"},Re={class:"dialog-footer"};var Fe=(0,n.pM)({__name:"ChartWrapper",setup(e){const l=["#409EFF","#67C23A","#E6A23C","#F56C6C","#909399"],a=(0,u.KR)([]);let r=500,o=100,i=r*o;const s=(0,u.KR)("数据曲线图");let d=[];const c=(0,u.KR)([]),v=(0,u.KR)([]);let m=null;const p=(0,u.KR)(!1),Fe=(0,u.KR)([]),xe=(0,u.KR)(""),Ve=(0,u.KR)([]),we=(0,u.KR)({sheetName:"",columnName:"",dataName:"",unit:"",valueFormat:"",hasHeader:!0}),Se=(0,u.KR)(!1),Ce=(0,u.KR)([]),Le=(0,u.KR)({seriesKey:"",targetSheetName:"",exportMode:"new",targetColumn:"",newColumnName:"",includeHeader:!0}),Ke=(0,u.KR)({seriesAKey:"",seriesBKey:"",operation:"subtract",resultName:"比对结果"}),Ne=(0,u.KR)(null),Ae=(0,u.KR)({seriesKey:"",operation:"add",value:0,applyMode:"new",newName:"修正后数据"}),Ee=(0,u.KR)(!1),We=(0,u.KR)(!1),Me=(0,u.KR)(null),Ue=(0,u.KR)({seriesKey:"",range:90,minPeakHeight:.5,minPeakDistance:.02}),Pe=(0,u.KR)(null),$e=(0,u.KR)([]),Ie=(0,u.KR)(!1),Xe=e=>{if(e.raw){Ie.value=!0;const l=k.Ks.service({lock:!0,text:"文件处理中...",background:"rgba(0, 0, 0, 0.7)"}),a=new FileReader;a.onload=e=>{try{const l=new Uint8Array(e.target?.result);m=W.LF(l,{type:"array"}),Fe.value=m.SheetNames,h.nk.success("文件上传成功！")}catch(a){h.nk.error("文件读取失败，请确保文件格式正确"),console.error("Excel文件读取错误:",a)}finally{Ie.value=!1,l.close()}},a.readAsArrayBuffer(e.raw)}return v.value=[e],!1},Oe=()=>{v.value=[],m=null,Fe.value=[],xe.value="",Ve.value=[]},He=()=>{0!==v.value.length?m?(we.value={sheetName:"",columnName:"",dataName:"",unit:"",valueFormat:"",hasHeader:!0},p.value=!0):h.nk.warning("文件未正确加载，请重新上传"):h.nk.warning("请先上传数据文件")},Be=e=>{m&&e?(we.value.sheetName=e,Te()):Ve.value=[]},je=()=>{we.value.sheetName&&Te()},Te=()=>{const e=we.value.sheetName,l=we.value.hasHeader;if(m&&e)try{const a=m.Sheets[e],t=W.Wp.decode_range(a["!ref"]||"A1"),n=[];if(l)for(let e=t.s.c;e<=t.e.c;e++){const l=W.Wp.encode_cell({r:0,c:e}),t=a[l];t&&t.v?n.push(t.v.toString()):n.push(`列${e+1}`)}else for(let e=t.s.c;e<=t.e.c;e++)n.push(`列${String.fromCharCode(65+e)}`);Ve.value=n}catch(a){h.nk.error("读取工作表失败"),console.error("工作表读取错误:",a)}else Ve.value=[]},ze=()=>{const e=we.value;if(e.sheetName&&e.columnName&&e.dataName)if(m)try{const l=m.Sheets[e.sheetName],t=W.Wp.decode_range(l["!ref"]||"A1");let n=-1;if(e.hasHeader)for(let a=t.s.c;a<=t.e.c;a++){const t=W.Wp.encode_cell({r:0,c:a}),u=l[t],r=u&&u.v?u.v.toString():`列${a+1}`;if(r===e.columnName){n=a;break}}else{const l=e.columnName.replace("列","");n=l.charCodeAt(0)-65}if(-1===n||n<t.s.c||n>t.e.c)return void h.nk.error("未找到指定列");const u=[],s=e.hasHeader?1:0;let c=s;for(;c<=t.e.r;c++){const e=W.Wp.encode_cell({r:c,c:n}),a=l[e],t=a&&a.v?parseFloat(a.v.toString()):0;if(!a){h.nk.warning(`第 ${c+1} 行数据无效，已跳过此后所有数据`);break}if("n"!=a.t&&"s"!=a.t){h.nk.warning(`第 ${c+1} 行数据无效，已跳过此后所有数据`);break}u.push(isNaN(t)?0:t)}i=c-s,r=i/o,d=L(r,o),h.nk.success(`检测到 ${u.length} 行数据，设置总时长为 ${r} 秒`);const v={key:Date.now(),label:`${e.dataName} (${e.sheetName})`,disabled:!1,serie:{name:e.dataName,data:u,yAxisName:`${e.dataName} (${e.unit})`,valueFormat:e.valueFormat||`{value} ${e.unit}`}};a.value.push(v),h.nk.success(`成功添加数据列：${e.dataName}`),p.value=!1}catch(l){h.nk.error("数据读取失败"),console.error("数据读取错误:",l)}else h.nk.error("Excel文件未加载");else h.nk.warning("请填写完整信息")},De=(0,n.EW)(()=>a.value.filter(e=>c.value.includes(e.key))),qe=(0,n.EW)(()=>Ke.value.seriesAKey&&Ke.value.seriesBKey&&Ke.value.seriesAKey!==Ke.value.seriesBKey&&""!==Ke.value.resultName.trim()),Qe=()=>{if(!qe.value)return void h.nk.warning("请选择两个不同的数据列并输入结果名称");const e=parseInt(Ke.value.seriesAKey),l=parseInt(Ke.value.seriesBKey),t=a.value.find(l=>l.key===e),n=a.value.find(e=>e.key===l);if(!t||!n)return void h.nk.error("找不到选中的数据列");const u=t.serie.data,i=n.serie.data,s=Math.min(u.length,i.length),d=[];for(let a=0;a<s;a++){let e=0;switch(Ke.value.operation){case"subtract":e=u[a]-i[a];break;case"reverseSubtract":e=i[a]-u[a];break;case"add":e=u[a]+i[a];break;case"multiply":e=u[a]*i[a];break;case"divide":e=0!==i[a]?u[a]/i[a]:0;break;default:e=u[a]-i[a]}d.push(e)}const c={name:Ke.value.resultName,data:d,yAxisName:`${Ke.value.resultName}`,valueFormat:"{value}"};Ne.value=c,console.log("Comparison result:",c),kl.value=!0,setTimeout(()=>{if(fl&&bl.value){const e=L(r,o),l=ul([c],e.slice(0,s));fl.setOption(l,!0),_l(),h.nk.success(`比对完成：${t.label} ${Ze(Ke.value.operation)} ${n.label}`)}else h.nk.error("结果图表初始化失败，请稍后重试")},100)},Ze=e=>{switch(e){case"subtract":return"-";case"reverseSubtract":return"(反向减法)";case"add":return"+";case"multiply":return"×";case"divide":return"÷";default:return"-"}},Ye=()=>{kl.value=!1,Ne.value=null,We.value||fl&&fl.clear(),h.nk.info("已清除比对结果")},Je=()=>{if(!Ne.value)return void h.nk.warning("没有可保存的比对结果");const e=a.value.find(e=>e.serie.name===Ne.value.name);if(e)return void h.nk.warning("已存在同名的数据系列，请修改结果名称后重新执行比对");const l={key:Date.now(),label:`${Ne.value.name} (比对结果)`,disabled:!1,serie:{...Ne.value}};a.value.push(l),h.nk.success(`比对结果已保存为数据系列：${Ne.value.name}`)},Ge=(0,n.EW)(()=>Ae.value.seriesKey&&Ae.value.operation&&void 0!==Ae.value.value&&("replace"===Ae.value.applyMode||"new"===Ae.value.applyMode&&""!==Ae.value.newName.trim())),el=(0,n.EW)(()=>Le.value.seriesKey&&Le.value.targetSheetName&&("replace"===Le.value.exportMode&&Le.value.targetColumn||"new"===Le.value.exportMode&&""!==Le.value.newColumnName.trim())),ll=()=>{if(!Ge.value)return void h.nk.warning("请完善修正参数");const e=parseInt(Ae.value.seriesKey),l=a.value.find(l=>l.key===e);if(!l)return void h.nk.error("找不到选中的数据列");const t=nl(l.serie.data,Ae.value.operation,Ae.value.value);if("replace"===Ae.value.applyMode)l.serie.data=t,h.nk.success(`已修正数据列：${l.label}`),c.value.includes(e)&&Vl();else{const e=a.value.find(e=>e.serie.name===Ae.value.newName);if(e)return void h.nk.warning("已存在同名的数据系列，请修改名称");const n={key:Date.now(),label:`${Ae.value.newName} (修正结果)`,disabled:!1,serie:{name:Ae.value.newName,data:t,yAxisName:l.serie.yAxisName,valueFormat:l.serie.valueFormat}};a.value.push(n),h.nk.success(`修正结果已保存为新数据系列：${Ae.value.newName}`)}tl()},al=()=>{if(!Ge.value)return void h.nk.warning("请完善修正参数");const e=parseInt(Ae.value.seriesKey),l=a.value.find(l=>l.key===e);if(!l)return void h.nk.error("找不到选中的数据列");const t=nl(l.serie.data,Ae.value.operation,Ae.value.value),n={name:`${l.serie.name} (预览)`,data:t,yAxisName:`${l.serie.yAxisName} (预览)`,valueFormat:l.serie.valueFormat};Me.value=n,We.value=!0,setTimeout(()=>{if(fl&&bl.value){const e=L(r,o),l=ul([n],e.slice(0,t.length));fl.setOption(l,!0),_l(),h.nk.success(`预览修正效果：${Ze(Ae.value.operation)} ${Ae.value.value}`)}else h.nk.error("预览图表初始化失败，请稍后重试")},100)},tl=()=>{We.value=!1,Me.value=null,fl&&fl.clear(),kl.value&&Ne.value&&setTimeout(()=>{if(fl&&bl.value){const e=L(r,o),l=ul([Ne.value],e.slice(0,Ne.value.data.length));fl.setOption(l,!0),_l()}},50)},nl=(e,l,a)=>"derivative"===l?Ee.value?E(A(e,o),o):A(e,o):e.map(e=>{switch(l){case"add":return e+a;case"subtract":return e-a;case"multiply":return e*a;case"divide":return 0!==a?e/a:e;case"expn":return Math.pow(e,a);case"log":return e>0?Math.log(e)/Math.log(a):e;case"exp":return Math.pow(a,e);default:return e}}),ul=(e,a,t)=>{const n={title:{text:s.value,left:"center",top:"5%",textStyle:{color:"#333",fontSize:16}},tooltip:{trigger:"axis",backgroundColor:"rgba(0, 0, 0, 0.8)",textStyle:{color:"#fff",fontSize:12},formatter:e=>{if(Array.isArray(e)&&e.length>0){const l=e[0].axisValue;let a=`时间: ${l}<br/>`;return e.forEach(e=>{"highlight-helper"!=e.seriesName&&(a+=`${e.marker}${e.seriesName}: ${e.value}<br/>`)}),a}return""}},legend:{data:e.map(e=>e.name),top:"8%",textStyle:{fontSize:12}},grid:{left:"6%",right:"4%",bottom:"8%",top:"18%",containLabel:!0},toolbox:{feature:{saveAsImage:{}},right:"2%",top:"8%"},dataZoom:[{type:"inside",start:0,end:100},{start:0,end:100,height:30,bottom:"2%"}],xAxis:{type:"category",boundaryGap:!1,data:a,axisLine:{lineStyle:{color:"#ddd"}},axisLabel:{color:"#666",fontSize:10,interval:Math.floor(i/20)},splitLine:{show:!0,lineStyle:{color:"#f5f5f5",type:"dashed"}}},yAxis:gl.value?[{type:"value",name:e.length>1?"数值":e[0].yAxisName,position:"left",axisLine:{lineStyle:{color:"#ddd"}},axisLabel:{formatter:"{value}",color:"#666",fontSize:10},splitLine:{show:!0,lineStyle:{color:"#f5f5f5",type:"dashed"}}}]:e.map(l=>({type:"value",name:l.yAxisName,position:0===e.indexOf(l)?"left":"right",axisLine:{lineStyle:{color:"#ddd"}},axisLabel:{formatter:l.valueFormat,color:"#666",fontSize:10},splitLine:{show:!0,lineStyle:{color:"#f5f5f5",type:"dashed"}}})),series:e.map((e,a)=>({name:e.name,type:"line",symbol:"none",data:e.data,smooth:!1,sampling:"lttb",lineStyle:{color:l[a%l.length],width:1.5},itemStyle:{color:l[a%l.length]},yAxisIndex:gl.value?0:a})),animation:!1,notMerge:!0};if(t&&e.length>0){const l=new Array(e[0].data.length).fill(0);for(let e=t.start;e<=t.end;e++)e>=0&&e<l.length&&(l[e]=1);const a=n.series;a.push({name:"highlight-helper",type:"line",data:l,showSymbol:!1,lineStyle:{opacity:0},itemStyle:{opacity:0},silent:!0}),n.visualMap={show:!1,type:"piecewise",seriesIndex:a.length-1,dimension:1,pieces:[{value:0,color:"transparent"},{value:1,color:"rgba(255, 0, 0, 0.2)"}]},a[0].markArea={silent:!0,itemStyle:{color:"rgba(255, 100, 100, 0.2)",borderColor:"rgba(255, 100, 100, 0.8)",borderWidth:1},data:[[{xAxis:t.start,name:"分析结果区间"},{xAxis:t.end}]]}}return n},rl=()=>{Pe.value=null,Vl(),h.nk.info("已清除分析结果")},ol=()=>{if(!Pe.value)return void h.nk.warning("没有分析结果可以高亮");const e={start:Pe.value.rangeStart,end:Pe.value.rangeEnd};Vl(e),h.nk.success("已高亮显示分析区间")},il=()=>{const e=Ue.value.seriesKey,l=Ue.value.range;if(!e||!l)return void h.nk.warning("请选择数据列并输入搜索范围");const t=a.value.find(l=>l.key===parseInt(e));if(!t)return void h.nk.error("找不到选中的数据列");const n=K(t.serie.data,l);if(-1===n.maxValueIndex)return void h.nk.error("未找到符合条件的最大值范围");Pe.value={maxValue:t.serie.data[n.maxValueIndex],maxValueIndex:n.maxValueIndex,rangeStart:n.rangeStart,rangeEnd:n.rangeEnd};const u={start:n.rangeStart,end:n.rangeEnd};c.value.includes(parseInt(e))?(Vl(u),h.nk.success(`分析完成！已在图表中高亮显示 ${l}% 最大值区间`)):h.nk.success("分析完成！请在数据列选择中选中该数据列以查看高亮区间")},sl=()=>{Ie.value=!0;const e=k.Ks.service({lock:!0,text:"处理中...",background:"rgba(0, 0, 0, 0.7)"}),l=Ue.value.seriesKey;if(!l)return void h.nk.warning("请选择数据列");const t=a.value.find(e=>e.key===parseInt(l));if(!t)return void h.nk.error("找不到选中的数据列");let n=[],u=1;if(t.serie.data.length>3e3){const e=3e3,l=Math.ceil(t.serie.data.length/e);u=l;for(let a=0;a<t.serie.data.length;a+=l)n.push(t.serie.data[a])}else n=t.serie.data.slice();const r=N(n,Ue.value.minPeakHeight,Ue.value.minPeakDistance);if(0===r.length)return h.nk.error("未找到符合条件的峰值"),Ie.value=!1,void e.close();if(u>1)for(let a=0;a<r.length;a++)r[a]*=u;Ie.value=!1,e.close(),$e.value=r,cl()},dl=(0,u.KR)(0),cl=()=>{if(0===$e.value.length)return void h.nk.warning("没有峰值搜索结果可以高亮");const e={start:$e.value[dl.value]-50,end:$e.value[dl.value]+50};Vl(e),h.nk.success("已高亮显示峰值搜索结果区间")},vl=()=>{$e.value=[],Vl(),h.nk.info("已清除峰值搜索结果")};let ml=null;const pl=(0,u.KR)();let fl=null;const bl=(0,u.KR)(),kl=(0,u.KR)(!1),hl=(0,u.KR)(0),yl=(0,u.KR)(50),gl=(0,u.KR)(!1),_l=()=>{if(!ml)return;hl.value>=yl.value&&(yl.value=hl.value+1);const e=hl.value/r*100,l=yl.value/r*100;ml.setOption({dataZoom:[{type:"inside",start:e,end:l},{start:e,end:l,height:30,bottom:"2%"}]})},Rl=()=>{hl.value=0,yl.value=Math.min(50,r),_l()},Fl=()=>{Vl(),gl.value?h.nk.success("已启用统一Y轴比例"):h.nk.info("已禁用统一Y轴比例")},xl=()=>{pl.value&&(ml=b.Ts(pl.value),fl=b.Ts(bl.value),ml.on("dataZoom",e=>{const l=e,a=l.start,t=l.end;hl.value=Math.round(a/100*r*100)/100,yl.value=Math.round(t/100*r*100)/100,fl&&fl.setOption({dataZoom:[{type:"inside",start:a,end:t},{start:a,end:t,height:30,bottom:"2%"}]})}),window.addEventListener("resize",Kl))},Vl=e=>{if(!ml)return;let l=a.value.map(e=>({key:e.key,label:e.label,disabled:e.disabled,serie:e.serie})).filter(e=>c.value.includes(e.key));if(console.log("Selected series:",l),0===l.length)return void h.nk.warning("请选择至少一个数据列");yl.value=r,hl.value=0;const t=l.map(e=>e.serie),n=L(r,o),u=ul(t,n,e);ml.setOption(u,!0)},wl=()=>{Vl()},Sl=()=>{m?0!==a.value.length?(Le.value={seriesKey:"",targetSheetName:Fe.value.length>0?Fe.value[0]:"",exportMode:"new",targetColumn:"",newColumnName:"",includeHeader:!0},Se.value=!0):h.nk.warning("没有可导出的数据列"):h.nk.error("Excel文件未加载")},Cl=()=>{const e=Le.value.targetSheetName;if(m&&e)try{const l=m.Sheets[e],a=W.Wp.decode_range(l["!ref"]||"A1"),t=[];for(let e=a.s.c;e<=a.e.c;e++){const a=W.Wp.encode_cell({r:0,c:e}),n=l[a];n&&n.v?t.push(n.v.toString()):t.push(`列${String.fromCharCode(65+e)}`)}Ce.value=t}catch(l){h.nk.error("读取工作表列名失败"),console.error("读取工作表列名错误:",l)}else Ce.value=[]},Ll=()=>{if(!el.value)return void h.nk.warning("请完善导出参数");const e=parseInt(Le.value.seriesKey),l=a.value.find(l=>l.key===e);if(!l)return void h.nk.error("找不到选中的数据列");if(!m)return void h.nk.error("Excel文件未加载");Ie.value=!0;const t=k.Ks.service({lock:!0,text:"正在导出数据...",background:"rgba(0, 0, 0, 0.7)"});try{const e=m.Sheets[Le.value.targetSheetName],a=W.Wp.decode_range(e["!ref"]||"A1");let t=-1;if("replace"===Le.value.exportMode){for(let l=a.s.c;l<=a.e.c;l++){const a=W.Wp.encode_cell({r:0,c:l}),n=e[a],u=n&&n.v?n.v.toString():`列${String.fromCharCode(65+l)}`;if(u===Le.value.targetColumn){t=l;break}}if(-1===t)return void h.nk.error("未找到指定的目标列")}else t=a.e.c+1;const n=l.serie.data;let u=0;if(Le.value.includeHeader){const l=W.Wp.encode_cell({r:0,c:t}),a="new"===Le.value.exportMode?Le.value.newColumnName:Le.value.targetColumn;e[l]={t:"s",v:a},u=1}for(let l=0;l<n.length;l++){const a=W.Wp.encode_cell({r:u+l,c:t});e[a]={t:"n",v:n[l]}}const r={s:{c:Math.min(a.s.c,t),r:a.s.r},e:{c:Math.max(a.e.c,t),r:Math.max(a.e.r,u+n.length-1)}};e["!ref"]=W.Wp.encode_range(r);const o=m,i=W.M9(o,{bookType:"xlsx",type:"array"}),s=new Blob([i],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),d=window.URL.createObjectURL(s),c=document.createElement("a");c.href=d,c.download=`导出数据_${(new Date).toISOString().slice(0,10)}.xlsx`,document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(d),Se.value=!1,"replace"===Le.value.exportMode?h.nk.success(`数据已成功替换到列"${Le.value.targetColumn}"`):h.nk.success(`数据已成功导出到新列"${Le.value.newColumnName}"`)}catch(n){h.nk.error("导出数据失败"),console.error("导出数据错误:",n)}finally{Ie.value=!1,t.close()}},Kl=()=>{ml&&ml.resize(),fl&&fl.resize()};return(0,n.sV)(()=>{xl()}),(0,n.hi)(()=>{ml&&ml.dispose(),window.removeEventListener("resize",Kl)}),(e,l)=>{const i=(0,n.g2)("upload-filled"),d=(0,n.g2)("el-icon"),m=(0,n.g2)("el-upload");return(0,n.uX)(),(0,n.CE)("div",M,[(0,n.Lk)("div",U,[(0,n.bF)(m,{class:"upload-demo",drag:"","auto-upload":!1,accept:".xlsx","file-list":v.value,"onUpdate:fileList":l[0]||(l[0]=e=>v.value=e),limit:1,"on-change":Xe,"on-remove":Oe},{default:(0,n.k6)(()=>[(0,n.bF)(d,{class:"el-icon--upload"},{default:(0,n.k6)(()=>[(0,n.bF)(i)]),_:1}),l[39]||(l[39]=(0,n.Lk)("div",{class:"el-upload__text"},[(0,n.eW)(" 拖曳或 "),(0,n.Lk)("em",null,"点击上传excel文件")],-1))]),_:1,__:[39]},8,["file-list"]),(0,n.bF)((0,u.R1)(y.Vl),{"expand-icon-position":"left"},{default:(0,n.k6)(()=>[(0,n.bF)((0,u.R1)(y.SS),{title:"数据列选择"},{default:(0,n.k6)(()=>[(0,n.Lk)("div",P,[(0,n.bF)((0,u.R1)(g.S2),{type:"primary",onClick:He,style:{"margin-right":"auto"}},{default:(0,n.k6)(()=>l[40]||(l[40]=[(0,n.eW)("导入数据列")])),_:1,__:[40]}),(0,n.bF)((0,u.R1)(_.dZ),{modelValue:c.value,"onUpdate:modelValue":l[1]||(l[1]=e=>c.value=e),data:a.value,titles:["可选数据列","已选数据列"]},null,8,["modelValue","data"]),(0,n.bF)((0,u.R1)(g.S2),{type:"primary",onClick:wl,style:{"margin-right":"auto"}},{default:(0,n.k6)(()=>l[41]||(l[41]=[(0,n.eW)("更新图表")])),_:1,__:[41]})])]),_:1}),(0,n.bF)((0,u.R1)(y.SS),{title:"单数据列运算"},{default:(0,n.k6)(()=>[(0,n.Lk)("div",$,[(0,n.Lk)("div",I,[l[42]||(l[42]=(0,n.Lk)("label",null,"选择数据列:",-1)),(0,n.bF)((0,u.R1)(R.AV),{modelValue:Ae.value.seriesKey,"onUpdate:modelValue":l[2]||(l[2]=e=>Ae.value.seriesKey=e),placeholder:"请选择要修正的数据列",style:{width:"250px"}},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(De.value,e=>((0,n.uX)(),(0,n.Wv)((0,u.R1)(R.P9),{key:e.key,label:e.label,value:e.key.toString()},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),(0,n.Lk)("div",X,[l[43]||(l[43]=(0,n.Lk)("label",null,"修正方式:",-1)),(0,n.bF)((0,u.R1)(R.AV),{modelValue:Ae.value.operation,"onUpdate:modelValue":l[3]||(l[3]=e=>Ae.value.operation=e),placeholder:"请选择修正方式",style:{width:"150px"}},{default:(0,n.k6)(()=>[(0,n.bF)((0,u.R1)(R.P9),{label:"加法 (+)",value:"add"}),(0,n.bF)((0,u.R1)(R.P9),{label:"减法 (-)",value:"subtract"}),(0,n.bF)((0,u.R1)(R.P9),{label:"乘法 (×)",value:"multiply"}),(0,n.bF)((0,u.R1)(R.P9),{label:"除法 (÷)",value:"divide"}),(0,n.bF)((0,u.R1)(R.P9),{label:"幂运算",value:"expn"}),(0,n.bF)((0,u.R1)(R.P9),{label:"指数运算",value:"exp"}),(0,n.bF)((0,u.R1)(R.P9),{label:"对数运算",value:"log"}),(0,n.bF)((0,u.R1)(R.P9),{label:"求导",value:"derivative"})]),_:1},8,["modelValue"])]),"derivative"!==Ae.value.operation?((0,n.uX)(),(0,n.CE)("div",O,[l[44]||(l[44]=(0,n.Lk)("label",null,"修正值:",-1)),(0,n.bF)((0,u.R1)(F.lq),{modelValue:Ae.value.value,"onUpdate:modelValue":l[4]||(l[4]=e=>Ae.value.value=e),precision:6,step:.1,style:{width:"200px"},placeholder:"请输入修正值"},null,8,["modelValue"])])):(0,n.Q3)("",!0),"derivative"==Ae.value.operation?((0,n.uX)(),(0,n.CE)("div",H,[l[45]||(l[45]=(0,n.Lk)("label",null,"是否平滑输出曲线:",-1)),(0,n.bF)((0,u.R1)(x.qi),{modelValue:Ee.value,"onUpdate:modelValue":l[5]||(l[5]=e=>Ee.value=e)},null,8,["modelValue"])])):(0,n.Q3)("",!0),(0,n.Lk)("div",B,[l[48]||(l[48]=(0,n.Lk)("label",null,"应用方式:",-1)),(0,n.bF)((0,u.R1)(V.MQ),{modelValue:Ae.value.applyMode,"onUpdate:modelValue":l[6]||(l[6]=e=>Ae.value.applyMode=e)},{default:(0,n.k6)(()=>[(0,n.bF)((0,u.R1)(V.ll),{value:"replace"},{default:(0,n.k6)(()=>l[46]||(l[46]=[(0,n.eW)("替换原数据")])),_:1,__:[46]}),(0,n.bF)((0,u.R1)(V.ll),{value:"new"},{default:(0,n.k6)(()=>l[47]||(l[47]=[(0,n.eW)("保存为新数据")])),_:1,__:[47]})]),_:1},8,["modelValue"])]),"new"===Ae.value.applyMode?((0,n.uX)(),(0,n.CE)("div",j,[l[49]||(l[49]=(0,n.Lk)("label",null,"新数据名称:",-1)),(0,n.bF)((0,u.R1)(w.WK),{modelValue:Ae.value.newName,"onUpdate:modelValue":l[7]||(l[7]=e=>Ae.value.newName=e),placeholder:"请输入新数据系列名称",style:{width:"200px"}},null,8,["modelValue"])])):(0,n.Q3)("",!0),(0,n.Lk)("div",T,[(0,n.bF)((0,u.R1)(g.S2),{type:"primary",onClick:ll,disabled:!Ge.value},{default:(0,n.k6)(()=>l[50]||(l[50]=[(0,n.eW)("执行修正")])),_:1,__:[50]},8,["disabled"]),(0,n.bF)((0,u.R1)(g.S2),{type:"warning",onClick:al,disabled:!Ge.value},{default:(0,n.k6)(()=>l[51]||(l[51]=[(0,n.eW)("预览效果")])),_:1,__:[51]},8,["disabled"]),(0,n.bF)((0,u.R1)(g.S2),{type:"info",onClick:tl,disabled:!We.value},{default:(0,n.k6)(()=>l[52]||(l[52]=[(0,n.eW)("清除预览")])),_:1,__:[52]},8,["disabled"])])])]),_:1}),(0,n.bF)((0,u.R1)(y.SS),{title:"双数据列运算"},{default:(0,n.k6)(()=>[(0,n.Lk)("div",z,[(0,n.Lk)("div",D,[(0,n.Lk)("div",q,[l[53]||(l[53]=(0,n.Lk)("label",null,"数据列A:",-1)),(0,n.bF)((0,u.R1)(R.AV),{modelValue:Ke.value.seriesAKey,"onUpdate:modelValue":l[8]||(l[8]=e=>Ke.value.seriesAKey=e),placeholder:"请选择第一个数据列",style:{width:"200px"}},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(De.value,e=>((0,n.uX)(),(0,n.Wv)((0,u.R1)(R.P9),{key:e.key,label:e.label,value:e.key.toString()},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),(0,n.Lk)("div",Q,[l[54]||(l[54]=(0,n.Lk)("label",null,"数据列B:",-1)),(0,n.bF)((0,u.R1)(R.AV),{modelValue:Ke.value.seriesBKey,"onUpdate:modelValue":l[9]||(l[9]=e=>Ke.value.seriesBKey=e),placeholder:"请选择第二个数据列",style:{width:"200px"}},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(De.value,e=>((0,n.uX)(),(0,n.Wv)((0,u.R1)(R.P9),{key:e.key,label:e.label,value:e.key.toString()},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),(0,n.Lk)("div",Z,[l[55]||(l[55]=(0,n.Lk)("label",null,"运算方式:",-1)),(0,n.bF)((0,u.R1)(R.AV),{modelValue:Ke.value.operation,"onUpdate:modelValue":l[10]||(l[10]=e=>Ke.value.operation=e),placeholder:"请选择运算方式",style:{width:"150px"}},{default:(0,n.k6)(()=>[(0,n.bF)((0,u.R1)(R.P9),{label:"A - B",value:"subtract"}),(0,n.bF)((0,u.R1)(R.P9),{label:"B - A",value:"reverseSubtract"}),(0,n.bF)((0,u.R1)(R.P9),{label:"A + B",value:"add"}),(0,n.bF)((0,u.R1)(R.P9),{label:"A × B",value:"multiply"}),(0,n.bF)((0,u.R1)(R.P9),{label:"A ÷ B",value:"divide"})]),_:1},8,["modelValue"])]),(0,n.Lk)("div",Y,[l[56]||(l[56]=(0,n.Lk)("label",null,"结果名称:",-1)),(0,n.bF)((0,u.R1)(w.WK),{modelValue:Ke.value.resultName,"onUpdate:modelValue":l[11]||(l[11]=e=>Ke.value.resultName=e),placeholder:"请输入结果系列名称",style:{width:"200px"}},null,8,["modelValue"])]),(0,n.Lk)("div",J,[(0,n.bF)((0,u.R1)(g.S2),{type:"primary",onClick:Qe,disabled:!qe.value},{default:(0,n.k6)(()=>l[57]||(l[57]=[(0,n.eW)("执行比对")])),_:1,__:[57]},8,["disabled"]),(0,n.bF)((0,u.R1)(g.S2),{type:"success",onClick:Je,disabled:!kl.value},{default:(0,n.k6)(()=>l[58]||(l[58]=[(0,n.eW)("保存结果")])),_:1,__:[58]},8,["disabled"]),(0,n.bF)((0,u.R1)(g.S2),{type:"info",onClick:Ye,disabled:!kl.value},{default:(0,n.k6)(()=>l[59]||(l[59]=[(0,n.eW)("清除结果")])),_:1,__:[59]},8,["disabled"])])])]),_:1}),(0,n.bF)((0,u.R1)(y.SS),{title:"数据分析"},{default:(0,n.k6)(()=>[(0,n.bF)((0,u.R1)(y.Vl),null,{default:(0,n.k6)(()=>[(0,n.bF)((0,u.R1)(y.SS),{title:"最值和区间"},{default:(0,n.k6)(()=>[(0,n.Lk)("div",G,[(0,n.bF)((0,u.R1)(R.AV),{modelValue:Ue.value.seriesKey,"onUpdate:modelValue":l[12]||(l[12]=e=>Ue.value.seriesKey=e),placeholder:"请选择要分析的数据列",style:{width:"250px"}},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(De.value,e=>((0,n.uX)(),(0,n.Wv)((0,u.R1)(R.P9),{key:e.key,label:e.label,value:e.key.toString()},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),(0,n.Lk)("div",ee,[l[60]||(l[60]=(0,n.Lk)("label",null,"搜索 x% 最大值范围：",-1)),(0,n.bF)((0,u.R1)(w.WK),{modelValue:Ue.value.range,"onUpdate:modelValue":l[13]||(l[13]=e=>Ue.value.range=e),placeholder:"请输入区间范围：",style:{width:"150px"}},null,8,["modelValue"])]),(0,n.Lk)("div",le,[(0,n.bF)((0,u.R1)(g.S2),{type:"primary",onClick:il},{default:(0,n.k6)(()=>l[61]||(l[61]=[(0,n.eW)("执行分析")])),_:1,__:[61]}),(0,n.bF)((0,u.R1)(g.S2),{type:"success",onClick:ol,disabled:!Pe.value},{default:(0,n.k6)(()=>l[62]||(l[62]=[(0,n.eW)("高亮区间")])),_:1,__:[62]},8,["disabled"]),(0,n.bF)((0,u.R1)(g.S2),{type:"info",onClick:rl},{default:(0,n.k6)(()=>l[63]||(l[63]=[(0,n.eW)("清除结果")])),_:1,__:[63]})]),Pe.value?((0,n.uX)(),(0,n.CE)("div",ae,[(0,n.Lk)("p",null,"最大值: "+(0,f.v_)(Pe.value.maxValue),1),(0,n.Lk)("p",null,"最大值位置: "+(0,f.v_)(Pe.value.maxValueIndex/100)+"秒",1),(0,n.Lk)("p",null,"指定百分数区间范围起点: "+(0,f.v_)(Pe.value.rangeStart/100)+"秒",1),(0,n.Lk)("p",null,"指定百分数区间范围终点: "+(0,f.v_)(Pe.value.rangeEnd/100)+"秒",1)])):(0,n.Q3)("",!0)])]),_:1}),(0,n.bF)((0,u.R1)(y.SS),{title:"峰值搜索"},{default:(0,n.k6)(()=>[(0,n.Lk)("div",te,[(0,n.bF)((0,u.R1)(R.AV),{modelValue:Ue.value.seriesKey,"onUpdate:modelValue":l[14]||(l[14]=e=>Ue.value.seriesKey=e),placeholder:"请选择要分析的数据列",style:{width:"250px","margin-right":"5px"}},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(De.value,e=>((0,n.uX)(),(0,n.Wv)((0,u.R1)(R.P9),{key:e.key,label:e.label,value:e.key.toString()},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),(0,n.Lk)("div",ne,[l[64]||(l[64]=(0,n.Lk)("label",null,"最小峰值高度:（相对于数据均值的倍数）",-1)),(0,n.bF)((0,u.R1)(F.lq),{modelValue:Ue.value.minPeakHeight,"onUpdate:modelValue":l[15]||(l[15]=e=>Ue.value.minPeakHeight=e),min:0,max:1e3,step:.1},null,8,["modelValue"])]),(0,n.Lk)("div",ue,[l[65]||(l[65]=(0,n.Lk)("label",null,"最小峰值距离：（相对数据总长度的倍数）",-1)),(0,n.bF)((0,u.R1)(F.lq),{modelValue:Ue.value.minPeakDistance,"onUpdate:modelValue":l[16]||(l[16]=e=>Ue.value.minPeakDistance=e),min:0,max:1,step:.01},null,8,["modelValue"])]),(0,n.Lk)("div",re,[(0,n.bF)((0,u.R1)(g.S2),{type:"primary",onClick:sl},{default:(0,n.k6)(()=>l[66]||(l[66]=[(0,n.eW)("执行峰值搜索")])),_:1,__:[66]}),(0,n.bF)((0,u.R1)(g.S2),{type:"success",onClick:cl,disabled:!$e.value},{default:(0,n.k6)(()=>l[67]||(l[67]=[(0,n.eW)("高亮峰值")])),_:1,__:[67]},8,["disabled"]),(0,n.bF)((0,u.R1)(g.S2),{type:"info",onClick:vl},{default:(0,n.k6)(()=>l[68]||(l[68]=[(0,n.eW)("清除峰值结果")])),_:1,__:[68]})])]),$e.value&&$e.value.length?((0,n.uX)(),(0,n.CE)("div",oe,[(0,n.Lk)("p",null,"共检测到 "+(0,f.v_)($e.value.length)+" 个峰值：",1),(0,n.Lk)("ul",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)($e.value,(e,l)=>((0,n.uX)(),(0,n.CE)("li",{key:l}," 峰值"+(0,f.v_)(l+1)+"：位置 "+(0,f.v_)((e/100).toFixed(2))+" 秒 ",1))),128))]),(0,n.Lk)("div",ie,[(0,n.Lk)("label",null,"当前高亮峰值："+(0,f.v_)(dl.value+1),1),(0,n.bF)((0,u.R1)(g.S2),{onClick:l[17]||(l[17]=e=>{dl.value=(dl.value-1+$e.value.length)%$e.value.length,cl()})},{default:(0,n.k6)(()=>l[69]||(l[69]=[(0,n.eW)(" 上一个峰值")])),_:1,__:[69]}),(0,n.bF)((0,u.R1)(g.S2),{onClick:l[18]||(l[18]=e=>{dl.value=(dl.value+1)%$e.value.length,cl()})},{default:(0,n.k6)(()=>l[70]||(l[70]=[(0,n.eW)(" 下一个峰值 ")])),_:1,__:[70]})])])):(0,n.Q3)("",!0)]),_:1})]),_:1})]),_:1}),(0,n.bF)((0,u.R1)(y.SS),{title:"数据列导出"},{default:(0,n.k6)(()=>[(0,n.Lk)("div",se,[(0,n.bF)((0,u.R1)(g.S2),{type:"primary",onClick:Sl},{default:(0,n.k6)(()=>l[71]||(l[71]=[(0,n.eW)("导出数据列到Excel")])),_:1,__:[71]})])]),_:1})]),_:1})]),(0,n.Lk)("div",de,[(0,n.Lk)("div",ce,[(0,n.Lk)("div",ve,[l[72]||(l[72]=(0,n.Lk)("label",null,"输入表格标题：",-1)),(0,n.bF)((0,u.R1)(w.WK),{modelValue:s.value,"onUpdate:modelValue":l[19]||(l[19]=e=>s.value=e),placeholder:"请输入图表标题",style:{width:"300px"}},null,8,["modelValue"])]),(0,n.Lk)("div",me,[(0,n.Lk)("div",pe,[l[73]||(l[73]=(0,n.Lk)("label",null,"起始点 (秒):",-1)),(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":l[20]||(l[20]=e=>hl.value=e),type:"number",min:"0",max:(0,u.R1)(r)-.01,step:"0.1",onChange:_l,class:"time-input"},null,40,fe),[[t.Jo,hl.value,void 0,{number:!0}]])]),(0,n.Lk)("div",be,[l[74]||(l[74]=(0,n.Lk)("label",null,"结束点 (秒):",-1)),(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":l[21]||(l[21]=e=>yl.value=e),type:"number",min:hl.value+.1,max:(0,u.R1)(r),step:"0.1",onChange:_l,class:"time-input"},null,40,ke),[[t.Jo,yl.value,void 0,{number:!0}]])]),(0,n.Lk)("button",{onClick:Rl,class:"reset-btn"},"重置"),(0,n.Lk)("span",he," 显示 "+(0,f.v_)(Math.round((yl.value-hl.value)*(0,u.R1)(o)))+" 个数据点 ",1)]),(0,n.Lk)("div",ye,[(0,n.Lk)("div",ge,[l[75]||(l[75]=(0,n.Lk)("label",null,"使用统一Y轴比例:",-1)),(0,n.bF)((0,u.R1)(x.qi),{modelValue:gl.value,"onUpdate:modelValue":l[22]||(l[22]=e=>gl.value=e),onChange:Fl},null,8,["modelValue"])])])]),(0,n.Lk)("div",{ref_key:"chartContainer",ref:pl,class:"chart-container"},null,512),(0,n.Lk)("div",{ref_key:"resultChartContainer",ref:bl,class:"chart-container"},null,512)]),(0,n.bF)((0,u.R1)(S.kZ),{modelValue:p.value,"onUpdate:modelValue":l[30]||(l[30]=e=>p.value=e),title:"选择数据列",width:"500px"},{footer:(0,n.k6)(()=>[(0,n.Lk)("span",_e,[(0,n.bF)((0,u.R1)(g.S2),{onClick:l[29]||(l[29]=e=>p.value=!1)},{default:(0,n.k6)(()=>l[76]||(l[76]=[(0,n.eW)("取消")])),_:1,__:[76]}),(0,n.bF)((0,u.R1)(g.S2),{type:"primary",onClick:ze},{default:(0,n.k6)(()=>l[77]||(l[77]=[(0,n.eW)("确认添加")])),_:1,__:[77]})])]),default:(0,n.k6)(()=>[(0,n.bF)((0,u.R1)(C.US),{model:we.value,"label-width":"100px"},{default:(0,n.k6)(()=>[(0,n.bF)((0,u.R1)(C.xE),{label:"工作表"},{default:(0,n.k6)(()=>[(0,n.bF)((0,u.R1)(R.AV),{modelValue:we.value.sheetName,"onUpdate:modelValue":l[23]||(l[23]=e=>we.value.sheetName=e),placeholder:"请选择工作表",onChange:Be,style:{width:"100%"}},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(Fe.value,e=>((0,n.uX)(),(0,n.Wv)((0,u.R1)(R.P9),{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,n.bF)((0,u.R1)(C.xE),{label:"是否有表头"},{default:(0,n.k6)(()=>[(0,n.bF)((0,u.R1)(R.AV),{modelValue:we.value.hasHeader,"onUpdate:modelValue":l[24]||(l[24]=e=>we.value.hasHeader=e),placeholder:"请选择",onChange:je,style:{width:"100%"}},{default:(0,n.k6)(()=>[(0,n.bF)((0,u.R1)(R.P9),{label:"是",value:!0}),(0,n.bF)((0,u.R1)(R.P9),{label:"否",value:!1})]),_:1},8,["modelValue"])]),_:1}),(0,n.bF)((0,u.R1)(C.xE),{label:"数据列"},{default:(0,n.k6)(()=>[(0,n.bF)((0,u.R1)(R.AV),{modelValue:we.value.columnName,"onUpdate:modelValue":l[25]||(l[25]=e=>we.value.columnName=e),placeholder:"请选择数据列",style:{width:"100%"},disabled:!we.value.sheetName},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(Ve.value,e=>((0,n.uX)(),(0,n.Wv)((0,u.R1)(R.P9),{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),(0,n.bF)((0,u.R1)(C.xE),{label:"数据名称"},{default:(0,n.k6)(()=>[(0,n.bF)((0,u.R1)(w.WK),{modelValue:we.value.dataName,"onUpdate:modelValue":l[26]||(l[26]=e=>we.value.dataName=e),placeholder:"请输入数据系列的显示名称"},null,8,["modelValue"])]),_:1}),(0,n.bF)((0,u.R1)(C.xE),{label:"单位"},{default:(0,n.k6)(()=>[(0,n.bF)((0,u.R1)(w.WK),{modelValue:we.value.unit,"onUpdate:modelValue":l[27]||(l[27]=e=>we.value.unit=e),placeholder:"请输入数据单位，如：°C、kPa等"},null,8,["modelValue"])]),_:1}),(0,n.bF)((0,u.R1)(C.xE),{label:"数值格式"},{default:(0,n.k6)(()=>[(0,n.bF)((0,u.R1)(w.WK),{modelValue:we.value.valueFormat,"onUpdate:modelValue":l[28]||(l[28]=e=>we.value.valueFormat=e),placeholder:"可选，如：{value} °C"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),(0,n.bF)((0,u.R1)(S.kZ),{modelValue:Se.value,"onUpdate:modelValue":l[38]||(l[38]=e=>Se.value=e),title:"导出数据到Excel",width:"600px"},{footer:(0,n.k6)(()=>[(0,n.Lk)("span",Re,[(0,n.bF)((0,u.R1)(g.S2),{onClick:l[37]||(l[37]=e=>Se.value=!1)},{default:(0,n.k6)(()=>l[80]||(l[80]=[(0,n.eW)("取消")])),_:1,__:[80]}),(0,n.bF)((0,u.R1)(g.S2),{type:"primary",onClick:Ll,disabled:!el.value},{default:(0,n.k6)(()=>l[81]||(l[81]=[(0,n.eW)("确认导出")])),_:1,__:[81]},8,["disabled"])])]),default:(0,n.k6)(()=>[(0,n.bF)((0,u.R1)(C.US),{model:Le.value,"label-width":"120px"},{default:(0,n.k6)(()=>[(0,n.bF)((0,u.R1)(C.xE),{label:"选择数据列"},{default:(0,n.k6)(()=>[(0,n.bF)((0,u.R1)(R.AV),{modelValue:Le.value.seriesKey,"onUpdate:modelValue":l[31]||(l[31]=e=>Le.value.seriesKey=e),placeholder:"请选择要导出的数据列",style:{width:"100%"}},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(a.value,e=>((0,n.uX)(),(0,n.Wv)((0,u.R1)(R.P9),{key:e.key,label:e.label,value:e.key.toString()},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,n.bF)((0,u.R1)(C.xE),{label:"目标工作表"},{default:(0,n.k6)(()=>[(0,n.bF)((0,u.R1)(R.AV),{modelValue:Le.value.targetSheetName,"onUpdate:modelValue":l[32]||(l[32]=e=>Le.value.targetSheetName=e),placeholder:"请选择目标工作表",style:{width:"100%"}},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(Fe.value,e=>((0,n.uX)(),(0,n.Wv)((0,u.R1)(R.P9),{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,n.bF)((0,u.R1)(C.xE),{label:"导出方式"},{default:(0,n.k6)(()=>[(0,n.bF)((0,u.R1)(V.MQ),{modelValue:Le.value.exportMode,"onUpdate:modelValue":l[33]||(l[33]=e=>Le.value.exportMode=e)},{default:(0,n.k6)(()=>[(0,n.bF)((0,u.R1)(V.ll),{value:"replace"},{default:(0,n.k6)(()=>l[78]||(l[78]=[(0,n.eW)("替换现有列")])),_:1,__:[78]}),(0,n.bF)((0,u.R1)(V.ll),{value:"new"},{default:(0,n.k6)(()=>l[79]||(l[79]=[(0,n.eW)("插入新列")])),_:1,__:[79]})]),_:1},8,["modelValue"])]),_:1}),"replace"===Le.value.exportMode?((0,n.uX)(),(0,n.Wv)((0,u.R1)(C.xE),{key:0,label:"目标列"},{default:(0,n.k6)(()=>[(0,n.bF)((0,u.R1)(R.AV),{modelValue:Le.value.targetColumn,"onUpdate:modelValue":l[34]||(l[34]=e=>Le.value.targetColumn=e),placeholder:"请选择要替换的列",style:{width:"100%"},onFocus:Cl},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(Ce.value,e=>((0,n.uX)(),(0,n.Wv)((0,u.R1)(R.P9),{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):(0,n.Q3)("",!0),"new"===Le.value.exportMode?((0,n.uX)(),(0,n.Wv)((0,u.R1)(C.xE),{key:1,label:"新列名称"},{default:(0,n.k6)(()=>[(0,n.bF)((0,u.R1)(w.WK),{modelValue:Le.value.newColumnName,"onUpdate:modelValue":l[35]||(l[35]=e=>Le.value.newColumnName=e),placeholder:"请输入新列的名称",style:{width:"100%"}},null,8,["modelValue"])]),_:1})):(0,n.Q3)("",!0),(0,n.bF)((0,u.R1)(C.xE),{label:"是否包含表头"},{default:(0,n.k6)(()=>[(0,n.bF)((0,u.R1)(x.qi),{modelValue:Le.value.includeHeader,"onUpdate:modelValue":l[36]||(l[36]=e=>Le.value.includeHeader=e)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}});const xe=(0,i.A)(Fe,[["__scopeId","data-v-57a635db"]]);var Ve=xe,we=(0,n.pM)({__name:"HomeView",setup(e){return(e,l)=>((0,n.uX)(),(0,n.Wv)(Ve))}});const Se=we;var Ce=Se;const Le=[{path:"/",name:"home",component:Ce},{path:"/about",name:"about",component:()=>a.e(67).then(a.bind(a,1067))}],Ke=(0,p.aE)({history:(0,p.Bt)(""),routes:Le});var Ne=Ke,Ae=a(72);a(4188);const Ee=(0,t.Ef)(m);for(const[We,Me]of Object.entries(r))Ee.component(We,Me);Ee.use(Ne).use(Ae.A).mount("#app")}},l={};function a(t){var n=l[t];if(void 0!==n)return n.exports;var u=l[t]={exports:{}};return e[t].call(u.exports,u,u.exports,a),u.exports}a.m=e,function(){var e=[];a.O=function(l,t,n,u){if(!t){var r=1/0;for(d=0;d<e.length;d++){t=e[d][0],n=e[d][1],u=e[d][2];for(var o=!0,i=0;i<t.length;i++)(!1&u||r>=u)&&Object.keys(a.O).every(function(e){return a.O[e](t[i])})?t.splice(i--,1):(o=!1,u<r&&(r=u));if(o){e.splice(d--,1);var s=n();void 0!==s&&(l=s)}}return l}u=u||0;for(var d=e.length;d>0&&e[d-1][2]>u;d--)e[d]=e[d-1];e[d]=[t,n,u]}}(),function(){a.d=function(e,l){for(var t in l)a.o(l,t)&&!a.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:l[t]})}}(),function(){a.f={},a.e=function(e){return Promise.all(Object.keys(a.f).reduce(function(l,t){return a.f[t](e,l),l},[]))}}(),function(){a.u=function(e){return"static/js/"+e+".63018e19.js"}}(),function(){a.miniCssF=function(e){return"static/css/"+e+".937f6be0.css"}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,l){return Object.prototype.hasOwnProperty.call(e,l)}}(),function(){var e={},l="visual:";a.l=function(t,n,u,r){if(e[t])e[t].push(n);else{var o,i;if(void 0!==u)for(var s=document.getElementsByTagName("script"),d=0;d<s.length;d++){var c=s[d];if(c.getAttribute("src")==t||c.getAttribute("data-webpack")==l+u){o=c;break}}o||(i=!0,o=document.createElement("script"),o.charset="utf-8",o.timeout=120,a.nc&&o.setAttribute("nonce",a.nc),o.setAttribute("data-webpack",l+u),o.src=t),e[t]=[n];var v=function(l,a){o.onerror=o.onload=null,clearTimeout(m);var n=e[t];if(delete e[t],o.parentNode&&o.parentNode.removeChild(o),n&&n.forEach(function(e){return e(a)}),l)return l(a)},m=setTimeout(v.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=v.bind(null,o.onerror),o.onload=v.bind(null,o.onload),i&&document.head.appendChild(o)}}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.p=""}(),function(){if("undefined"!==typeof document){var e=function(e,l,t,n,u){var r=document.createElement("link");r.rel="stylesheet",r.type="text/css",a.nc&&(r.nonce=a.nc);var o=function(a){if(r.onerror=r.onload=null,"load"===a.type)n();else{var t=a&&a.type,o=a&&a.target&&a.target.href||l,i=new Error("Loading CSS chunk "+e+" failed.\n("+t+": "+o+")");i.name="ChunkLoadError",i.code="CSS_CHUNK_LOAD_FAILED",i.type=t,i.request=o,r.parentNode&&r.parentNode.removeChild(r),u(i)}};return r.onerror=r.onload=o,r.href=l,t?t.parentNode.insertBefore(r,t.nextSibling):document.head.appendChild(r),r},l=function(e,l){for(var a=document.getElementsByTagName("link"),t=0;t<a.length;t++){var n=a[t],u=n.getAttribute("data-href")||n.getAttribute("href");if("stylesheet"===n.rel&&(u===e||u===l))return n}var r=document.getElementsByTagName("style");for(t=0;t<r.length;t++){n=r[t],u=n.getAttribute("data-href");if(u===e||u===l)return n}},t=function(t){return new Promise(function(n,u){var r=a.miniCssF(t),o=a.p+r;if(l(r,o))return n();e(t,o,null,n,u)})},n={524:0};a.f.miniCss=function(e,l){var a={67:1};n[e]?l.push(n[e]):0!==n[e]&&a[e]&&l.push(n[e]=t(e).then(function(){n[e]=0},function(l){throw delete n[e],l}))}}}(),function(){var e={524:0};a.f.j=function(l,t){var n=a.o(e,l)?e[l]:void 0;if(0!==n)if(n)t.push(n[2]);else{var u=new Promise(function(a,t){n=e[l]=[a,t]});t.push(n[2]=u);var r=a.p+a.u(l),o=new Error,i=function(t){if(a.o(e,l)&&(n=e[l],0!==n&&(e[l]=void 0),n)){var u=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;o.message="Loading chunk "+l+" failed.\n("+u+": "+r+")",o.name="ChunkLoadError",o.type=u,o.request=r,n[1](o)}};a.l(r,i,"chunk-"+l,l)}},a.O.j=function(l){return 0===e[l]};var l=function(l,t){var n,u,r=t[0],o=t[1],i=t[2],s=0;if(r.some(function(l){return 0!==e[l]})){for(n in o)a.o(o,n)&&(a.m[n]=o[n]);if(i)var d=i(a)}for(l&&l(t);s<r.length;s++)u=r[s],a.o(e,u)&&e[u]&&e[u][0](),e[u]=0;return a.O(d)},t=self["webpackChunkvisual"]=self["webpackChunkvisual"]||[];t.forEach(l.bind(null,0)),t.push=l.bind(null,t.push.bind(t))}();var t=a.O(void 0,[504],function(){return a(7222)});t=a.O(t)})();